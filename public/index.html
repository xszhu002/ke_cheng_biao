<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯¾ç¨‹è¡¨ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/schedule.css">
    <link rel="stylesheet" href="css/calendar.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <div class="app-container">
        <!-- é¡¶éƒ¨å·¥å…·æ  -->
        <header class="top-toolbar">
            <div class="toolbar-left">
                <h1>è¯¾ç¨‹è¡¨ç®¡ç†ç³»ç»Ÿ</h1>
                <div class="teacher-selector">
                    <label for="teacher-select">é€‰æ‹©æ•™å¸ˆï¼š</label>
                    <select id="teacher-select">
                        <option value="">è¯·é€‰æ‹©æ•™å¸ˆ...</option>
                    </select>
                </div>
            </div>
            <div class="toolbar-center">
                <div class="week-navigation">
                    <button id="prev-week" class="nav-btn">ä¸Šä¸€å‘¨</button>
                    <span id="current-week" class="week-display">ç¬¬1å‘¨</span>
                    <button id="next-week" class="nav-btn">ä¸‹ä¸€å‘¨</button>
                </div>
                <div class="date-range">
                    <span id="date-range-display">è¯·é€‰æ‹©æ•™å¸ˆ</span>
                </div>
            </div>
            <div class="toolbar-right">
                <button id="calendar-toggle" class="btn btn-secondary">æ—¥å†è§†å›¾</button>
                <button id="edit-btn" class="btn btn-secondary">ç¼–è¾‘è¯¾è¡¨</button>
                <button id="save-btn" class="btn btn-primary" style="display: none;">ä¿å­˜</button>
                <button id="cancel-edit-btn" class="btn btn-warning" style="display: none;">å–æ¶ˆç¼–è¾‘</button>
                <button id="reset-btn" class="btn btn-warning">å¤ä½</button>
                <button id="admin-btn" class="btn btn-danger">ç®¡ç†å‘˜</button>
            </div>
        </header>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <!-- å·¦ä¾§ä¸»åŒºåŸŸ -->
            <div class="left-main-area">
                <!-- ä¸­å¤®è¯¾ç¨‹è¡¨åŒºåŸŸ -->
                <section class="schedule-container">
                <div class="schedule-wrapper">
                    <table class="schedule-table" id="schedule-table">
                        <thead>
                            <tr>
                                <th class="time-header">æ˜ŸæœŸ/èŠ‚æ•°</th>
                                <th>æ˜ŸæœŸä¸€</th>
                                <th>æ˜ŸæœŸäºŒ</th>
                                <th>æ˜ŸæœŸä¸‰</th>
                                <th>æ˜ŸæœŸå››</th>
                                <th>æ˜ŸæœŸäº”</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- æ—¶é—´æ®µè¡Œ -->
                            <tr data-time-slot="1">
                                <td class="time-slot-header">
                                    <div class="time-info">
                                        <span class="time-name">ä¸Šåˆ1</span>
                                        <span class="time-range">8:30-9:10</span>
                                    </div>
                                </td>
                                <td class="time-slot" data-weekday="1" data-time-slot="1"></td>
                                <td class="time-slot" data-weekday="2" data-time-slot="1"></td>
                                <td class="time-slot" data-weekday="3" data-time-slot="1"></td>
                                <td class="time-slot" data-weekday="4" data-time-slot="1"></td>
                                <td class="time-slot" data-weekday="5" data-time-slot="1"></td>
                            </tr>
                            <tr data-time-slot="2">
                                <td class="time-slot-header">
                                    <div class="time-info">
                                        <span class="time-name">ä¸Šåˆ2</span>
                                        <span class="time-range">9:50-10:30</span>
                                    </div>
                                </td>
                                <td class="time-slot" data-weekday="1" data-time-slot="2"></td>
                                <td class="time-slot" data-weekday="2" data-time-slot="2"></td>
                                <td class="time-slot" data-weekday="3" data-time-slot="2"></td>
                                <td class="time-slot" data-weekday="4" data-time-slot="2"></td>
                                <td class="time-slot" data-weekday="5" data-time-slot="2"></td>
                            </tr>
                            <tr data-time-slot="3">
                                <td class="time-slot-header">
                                    <div class="time-info">
                                        <span class="time-name">ä¸Šåˆ3</span>
                                        <span class="time-range">10:45-11:30</span>
                                    </div>
                                </td>
                                <td class="time-slot" data-weekday="1" data-time-slot="3"></td>
                                <td class="time-slot" data-weekday="2" data-time-slot="3"></td>
                                <td class="time-slot" data-weekday="3" data-time-slot="3"></td>
                                <td class="time-slot" data-weekday="4" data-time-slot="3"></td>
                                <td class="time-slot" data-weekday="5" data-time-slot="3"></td>
                            </tr>
                            <tr data-time-slot="4">
                                <td class="time-slot-header">
                                    <div class="time-info">
                                        <span class="time-name">åˆé—´ç®¡ç†</span>
                                        <span class="time-range">åˆä¼‘æ—¶é—´</span>
                                    </div>
                                </td>
                                <td class="time-slot" data-weekday="1" data-time-slot="4"></td>
                                <td class="time-slot" data-weekday="2" data-time-slot="4"></td>
                                <td class="time-slot" data-weekday="3" data-time-slot="4"></td>
                                <td class="time-slot" data-weekday="4" data-time-slot="4"></td>
                                <td class="time-slot" data-weekday="5" data-time-slot="4"></td>
                            </tr>
                            <tr data-time-slot="5">
                                <td class="time-slot-header">
                                    <div class="time-info">
                                        <span class="time-name">ä¸‹åˆ1</span>
                                        <span class="time-range">13:30-14:10</span>
                                    </div>
                                </td>
                                <td class="time-slot" data-weekday="1" data-time-slot="5"></td>
                                <td class="time-slot" data-weekday="2" data-time-slot="5"></td>
                                <td class="time-slot" data-weekday="3" data-time-slot="5"></td>
                                <td class="time-slot" data-weekday="4" data-time-slot="5"></td>
                                <td class="time-slot" data-weekday="5" data-time-slot="5"></td>
                            </tr>
                            <tr data-time-slot="6">
                                <td class="time-slot-header">
                                    <div class="time-info">
                                        <span class="time-name">ä¸‹åˆ2</span>
                                        <span class="time-range">14:20-15:05</span>
                                    </div>
                                </td>
                                <td class="time-slot" data-weekday="1" data-time-slot="6"></td>
                                <td class="time-slot" data-weekday="2" data-time-slot="6"></td>
                                <td class="time-slot" data-weekday="3" data-time-slot="6"></td>
                                <td class="time-slot" data-weekday="4" data-time-slot="6"></td>
                                <td class="time-slot" data-weekday="5" data-time-slot="6"></td>
                            </tr>
                            <tr data-time-slot="7">
                                <td class="time-slot-header">
                                    <div class="time-info">
                                        <span class="time-name">ä¸‹åˆ3</span>
                                        <span class="time-range">15:15-15:55</span>
                                    </div>
                                </td>
                                <td class="time-slot" data-weekday="1" data-time-slot="7"></td>
                                <td class="time-slot" data-weekday="2" data-time-slot="7"></td>
                                <td class="time-slot" data-weekday="3" data-time-slot="7"></td>
                                <td class="time-slot" data-weekday="4" data-time-slot="7"></td>
                                <td class="time-slot" data-weekday="5" data-time-slot="7"></td>
                            </tr>
                            <tr data-time-slot="8">
                                <td class="time-slot-header">
                                    <div class="time-info">
                                        <span class="time-name">æ™šæ‰˜</span>
                                        <span class="time-range">æ”¾å­¦åæ‰˜ç®¡</span>
                                    </div>
                                </td>
                                <td class="time-slot" data-weekday="1" data-time-slot="8"></td>
                                <td class="time-slot" data-weekday="2" data-time-slot="8"></td>
                                <td class="time-slot" data-weekday="3" data-time-slot="8"></td>
                                <td class="time-slot" data-weekday="4" data-time-slot="8"></td>
                                <td class="time-slot" data-weekday="5" data-time-slot="8"></td>
                            </tr>
                            <tr data-time-slot="9" class="special-care-row">
                                <td class="time-slot-header special-care-header">
                                    <div class="time-info">
                                        <span class="time-name">ç‰¹éœ€æ‰˜ç®¡</span>
                                        <span class="time-range">ç‰¹æ®Šå®‰æ’</span>
                                    </div>
                                </td>
                                <td class="time-slot special-care-slot" data-weekday="1" data-time-slot="9"></td>
                                <td class="time-slot special-care-slot" data-weekday="2" data-time-slot="9"></td>
                                <td class="time-slot special-care-slot" data-weekday="3" data-time-slot="9"></td>
                                <td class="time-slot special-care-slot" data-weekday="4" data-time-slot="9"></td>
                                <td class="time-slot special-care-slot" data-weekday="5" data-time-slot="9"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- éšæ‰‹è®°åŠŸèƒ½ -->
            <div class="notes-section">
                <div class="notes-header">
                    <h3>ğŸ“ éšæ‰‹è®°</h3>
                    <div class="notes-week-info">
                        <span id="notes-week-display">ç¬¬1å‘¨</span>
                        <div class="notes-buttons">
                            <div id="notes-view-buttons" class="notes-view-buttons">
                                <button id="notes-toggle-mode" class="notes-toggle-btn">ç¼–è¾‘</button>
                            </div>
                            <div id="notes-edit-buttons" class="notes-edit-buttons hidden">
                                <button id="notes-save" class="notes-btn notes-save">ä¿å­˜</button>
                                <button id="notes-cancel" class="notes-btn notes-cancel">å–æ¶ˆ</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="notes-container">
                    <div id="notes-editor" class="notes-editor hidden">
                        <textarea id="notes-textarea" placeholder="æ”¯æŒMarkdownè¯­æ³•ï¼Œè®°å½•æœ¬å‘¨çš„æƒ³æ³•ã€è®¡åˆ’æˆ–é‡è¦äº‹é¡¹..."></textarea>
                        <div class="notes-editor-toolbar">
                            <span class="notes-help">æ”¯æŒ **ç²—ä½“** *æ–œä½“* `ä»£ç ` ç­‰Markdownè¯­æ³•</span>
                        </div>
                    </div>
                    <div id="notes-preview" class="notes-preview">
                        <div class="notes-content">æš‚æ— è®°å½•ï¼Œç‚¹å‡»"ç¼–è¾‘"å¼€å§‹è®°å½•...</div>
                    </div>
                </div>
            </div>
        </div>

            <!-- å³ä¾§ä¿¡æ¯é¢æ¿ -->
            <aside class="right-panel">
                <div class="panel-section">
                    <h3>è¯¾ç¨‹è¯¦æƒ…</h3>
                    <div id="course-details" class="course-details">
                        <p>ç‚¹å‡»è¯¾ç¨‹æŸ¥çœ‹è¯¦æƒ…</p>
                    </div>
                </div>

                                    <div class="panel-section">
                        <h3>å¾…åŠäº‹é¡¹</h3>
                        <div class="todo-tabs">
                            <div class="tab-buttons">
                                <button class="tab-button active" data-tab="pending">å¾…åŠ</button>
                                <button class="tab-button" data-tab="completed">å®Œæˆ</button>
                            </div>
                            <div class="tab-content">
                                <div id="todo-list-pending" class="todo-list tab-pane active">
                                    <div class="todo-loading">æ­£åœ¨åŠ è½½å¾…åŠäº‹é¡¹...</div>
                                </div>
                                <div id="todo-list-completed" class="todo-list tab-pane">
                                    <div class="todo-loading">æ­£åœ¨åŠ è½½å·²å®Œæˆäº‹é¡¹...</div>
                                </div>
                            </div>
                        </div>
                    </div>
            </aside>
        </main>



        <!-- æ—¥å†è§†å›¾ï¼ˆé»˜è®¤éšè—ï¼‰ -->
        <div id="calendar-view" class="calendar-view" style="display: none;">
            <div class="calendar-header">
                <button id="calendar-prev-month" class="nav-btn">ä¸Šä¸ªæœˆ</button>
                <h2 id="calendar-month-year">2024å¹´9æœˆ</h2>
                <button id="calendar-next-month" class="nav-btn">ä¸‹ä¸ªæœˆ</button>
                <button id="calendar-close" class="btn btn-secondary">å…³é—­æ—¥å†</button>
            </div>
            <div id="calendar-grid" class="calendar-grid">
                <!-- æ—¥å†ç½‘æ ¼å°†åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- è¯¾ç¨‹æ·»åŠ /ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="course-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">æ·»åŠ è¯¾ç¨‹</h3>
                <button class="modal-close" onclick="this.closest('.modal-overlay').style.display='none'">&times;</button>
            </div>
            <div class="modal-body">
                <form id="course-form">
                    <div class="form-group">
                        <label for="course-name">è¯¾ç¨‹åç§°ï¼š</label>
                        <input type="text" id="course-name" name="courseName" required>
                    </div>
                    <div class="form-group">
                        <label for="course-classroom">æ•™å®¤ï¼š</label>
                        <input type="text" id="course-classroom" name="classroom">
                    </div>
                    <div class="form-group">
                        <label for="course-teacher">ä»»è¯¾æ•™å¸ˆï¼š</label>
                        <input type="text" id="course-teacher" name="teacher" readonly style="background-color: #f8f9fa;">
                    </div>
                    <div class="form-group">
                        <label for="course-notes">å¤‡æ³¨ï¼š</label>
                        <textarea id="course-notes" name="notes" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="this.closest('.modal-overlay').style.display='none'">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" onclick="submitCourseForm()">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <!-- ç‰¹éœ€æ‰˜ç®¡æ·»åŠ /ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="special-care-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">æ·»åŠ ç‰¹éœ€æ‰˜ç®¡</h3>
                <button class="modal-close" onclick="this.closest('.modal-overlay').style.display='none'">&times;</button>
            </div>
            <div class="modal-body">
                <form id="special-care-form">
                    <div class="form-group">
                        <label for="care-date">æ—¥æœŸï¼š</label>
                        <input type="date" id="care-date" name="specificDate" required>
                    </div>
                    <div class="form-group">
                        <label for="care-name">æ‰˜ç®¡åç§°ï¼š</label>
                        <input type="text" id="care-name" name="courseName" required>
                    </div>
                    <div class="form-group">
                        <label for="care-classroom">åœ°ç‚¹ï¼š</label>
                        <input type="text" id="care-classroom" name="classroom">
                    </div>
                    <div class="form-group">
                        <label for="care-notes">å¤‡æ³¨ï¼š</label>
                        <textarea id="care-notes" name="notes" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="this.closest('.modal-overlay').style.display='none'">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" onclick="submitSpecialCareForm()">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <!-- é€šç”¨æ¨¡æ€å¯¹è¯æ¡† -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">æ ‡é¢˜</h3>
                <button id="modal-close" class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- æ¨¡æ€æ¡†å†…å®¹å°†åŠ¨æ€åŠ è½½ -->
            </div>
            <div class="modal-footer">
                <button id="modal-cancel" class="btn btn-secondary">å–æ¶ˆ</button>
                <button id="modal-confirm" class="btn btn-primary">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <!-- ä»»åŠ¡è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="task-detail-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ä»»åŠ¡ç®¡ç†</h3>
                <button class="modal-close" onclick="this.closest('.modal-overlay').style.display='none'">&times;</button>
            </div>
            <div class="modal-body">
                <div class="task-list-container">
                    <div class="task-list-header">
                        <h4 id="task-course-info"></h4>
                        <button class="btn btn-primary" onclick="scheduleManager.showAddTaskModal()">æ·»åŠ ä»»åŠ¡</button>
                    </div>
                    <div id="task-list"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- æ·»åŠ /ç¼–è¾‘ä»»åŠ¡æ¨¡æ€æ¡† -->
    <div id="add-task-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="task-modal-title">æ·»åŠ ä»»åŠ¡</h3>
                <button class="modal-close" onclick="this.closest('.modal-overlay').style.display='none'">&times;</button>
            </div>
            <div class="modal-body">
                <form id="task-form">
                    <input type="hidden" id="task-id" />
                    <input type="hidden" id="task-schedule-id" />
                    <input type="hidden" id="task-weekday" />
                    <input type="hidden" id="task-time-slot" />
                    
                    <div class="form-group">
                        <label for="task-title">ä»»åŠ¡æ ‡é¢˜ *</label>
                        <input type="text" id="task-title" required maxlength="100" />
                    </div>
                    
                    <div class="form-group">
                        <label for="task-description">ä»»åŠ¡æè¿°</label>
                        <textarea id="task-description" rows="3"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="task-type">ä»»åŠ¡ç±»å‹</label>
                            <select id="task-type">
                                <option value="preparation">å¤‡è¯¾</option>
                                <option value="grading">æ‰¹æ”¹</option>
                                <option value="meeting">ä¼šè®®</option>
                                <option value="assessment">æµ‹éªŒ</option>
                                <option value="general">å…¶ä»–</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="task-priority">ä¼˜å…ˆçº§</label>
                            <select id="task-priority">
                                <option value="3">ä½</option>
                                <option value="2" selected>ä¸­</option>
                                <option value="1">é«˜</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="task-due-date">æˆªæ­¢æ—¥æœŸ</label>
                            <input type="date" id="task-due-date" />
                        </div>
                        
                        <div class="form-group">
                            <label for="task-due-time">æˆªæ­¢æ—¶é—´</label>
                            <input type="time" id="task-due-time" />
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="this.closest('.modal-overlay').style.display='none'">å–æ¶ˆ</button>
                        <button type="button" class="btn btn-primary" onclick="handleTaskSubmit(event)">ä¿å­˜</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div id="loading-indicator" class="loading-indicator" style="display: none;">
        <div class="spinner"></div>
        <p>åŠ è½½ä¸­...</p>
    </div>

    <!-- JavaScriptæ–‡ä»¶ -->
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="js/toast.js"></script>
    <script src="js/dragdrop.js"></script>
    <script src="js/schedule.js"></script>
    <script src="js/calendar.js"></script>
    <script src="js/notes.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        // æäº¤è¯¾ç¨‹è¡¨å•
        async function submitCourseForm() {
            const form = document.getElementById('course-form');
            
            try {
                // ç›´æ¥è·å–è¡¨å•å­—æ®µçš„å€¼
                const scheduleId = parseInt(form.dataset.scheduleId);
                const weekday = parseInt(form.dataset.weekday);
                const timeSlot = parseInt(form.dataset.timeSlot);
                const courseName = form.querySelector('#course-name').value;
                const classroom = form.querySelector('#course-classroom').value;
                const teacher = form.querySelector('#course-teacher').value;
                const notes = form.querySelector('#course-notes').value;
                
                console.log('è¡¨å•æ•°æ®:', { scheduleId, weekday, timeSlot, courseName, classroom, teacher, notes });
                
                const courseData = {
                    scheduleId,
                    weekday,
                    timeSlot,
                    courseName,
                    classroom,
                    teacher,
                    notes,
                    isEditMode: window.app.scheduleManager.isEditMode
                };
                
                await API.Course.create(courseData);
                NotificationUtils.success('è¯¾ç¨‹æ·»åŠ æˆåŠŸ');
                
                // å…³é—­æ¨¡æ€æ¡†
                document.getElementById('course-modal').style.display = 'none';
                
                // é‡æ–°åŠ è½½è¯¾ç¨‹è¡¨
                if (window.app && window.app.scheduleManager) {
                    if (window.app.scheduleManager.isEditMode) {
                        // ç¼–è¾‘æ¨¡å¼ä¸‹é‡æ–°åŠ è½½åŸå§‹è¯¾ç¨‹è¡¨
                        await window.app.scheduleManager.loadOriginalCourses();
                    } else {
                        // æ™®é€šæ¨¡å¼ä¸‹é‡æ–°åŠ è½½å‘¨è¯¾ç¨‹è¡¨
                        await window.app.scheduleManager.loadWeekSchedule();
                    }
                }
                
            } catch (error) {
                console.error('æ·»åŠ è¯¾ç¨‹å¤±è´¥:', error);
                NotificationUtils.error('æ·»åŠ è¯¾ç¨‹å¤±è´¥: ' + error.message);
            }
        }
        
        // æäº¤ç‰¹éœ€æ‰˜ç®¡è¡¨å•
        async function submitSpecialCareForm() {
            const form = document.getElementById('special-care-form');
            
            try {
                // ç›´æ¥è·å–è¡¨å•å­—æ®µçš„å€¼
                const scheduleId = parseInt(form.dataset.scheduleId);
                const specificDate = form.querySelector('#care-date').value;
                const courseName = form.querySelector('#care-name').value;
                const classroom = form.querySelector('#care-classroom').value;
                const notes = form.querySelector('#care-notes').value;
                
                console.log('ç‰¹éœ€æ‰˜ç®¡æ•°æ®:', { scheduleId, specificDate, courseName, classroom, notes });
                
                const careData = {
                    scheduleId,
                    specificDate,
                    courseName,
                    classroom,
                    notes,
                    isEditMode: window.app.scheduleManager.isEditMode
                };
                
                await API.SpecialCare.create(careData);
                NotificationUtils.success('ç‰¹éœ€æ‰˜ç®¡æ·»åŠ æˆåŠŸ');
                
                // å…³é—­æ¨¡æ€æ¡†
                document.getElementById('special-care-modal').style.display = 'none';
                
                // é‡æ–°åŠ è½½è¯¾ç¨‹è¡¨
                if (window.app && window.app.scheduleManager) {
                    if (window.app.scheduleManager.isEditMode) {
                        // ç¼–è¾‘æ¨¡å¼ä¸‹é‡æ–°åŠ è½½åŸå§‹è¯¾ç¨‹è¡¨
                        await window.app.scheduleManager.loadOriginalCourses();
                    } else {
                        // æ™®é€šæ¨¡å¼ä¸‹é‡æ–°åŠ è½½å‘¨è¯¾ç¨‹è¡¨
                        await window.app.scheduleManager.loadWeekSchedule();
                    }
                }
                
            } catch (error) {
                console.error('æ·»åŠ ç‰¹éœ€æ‰˜ç®¡å¤±è´¥:', error);
                NotificationUtils.error('æ·»åŠ ç‰¹éœ€æ‰˜ç®¡å¤±è´¥: ' + error.message);
            }
        }
    </script>

    <!-- Toastæç¤ºå®¹å™¨ -->
    <div id="toast-container" class="toast-container"></div>
</body>
</html> 